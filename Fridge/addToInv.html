<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CookIT | Add Items to Inventory</title>
    <link rel="stylesheet" href="addToInvStyle.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <header>
        <div>
            <div id="mySidenav" class="sidenav">
                <a href="javascript:void(0)" class="closebtn" onclick="toggleNav('mySidenav')">&times;</a>
                <a href="#">About</a>
                <a href="#">Services</a>
                <a href="#">Clients</a>
                <a href="#">Contact</a>
            </div>
            <!-- three lines icons -->
            <span style="font-size:30px;cursor:pointer" onclick="toggleNav('mySidenav')">&#9776;</span>
        </div>
        <h1>CookIT</h1>
        <div>
            <div id="fridgeSidenav" class="sidenav fridgeSidenav">
                <a href="javascript:void(0)" class="closebtn" onclick="toggleNav('fridgeSidenav')">&times;</a>
                <div class="fridgeSidenav-container">
                    <h2>Add Items to Inventory</h2>
                    
                    <div class="fridgeSidenav-itemsContainer">
                    </div>

                    <button onclick="updateFridge()">Update Inventory</button>
                </div>
            </div>
            <!-- FRIDGE ICON -->
            <img style="cursor:pointer" onclick="toggleNav('fridgeSidenav')" src="assets/fridgeIcon.png" />
        </div>
    </header>
</head>

<body>
    <div class="app">
        <div class="search">
            <h2>Add Items Now</h2>
            <p>By Searching with the seach bar, or by browsing through the categories</p>
            <div class="search-container">
                <form action="/action_page.php">
                    <input type="text" placeholder="Search.." name="search">
                    <button type="submit"><i class="fa fa-search"></i></button>
                </form>
            </div>
        </div>

        <div class="browseContainer">
            <h3>Browse by Category</h3>
            <div class="filter">
                <div class="itemFilter" onclick="sortCategory('Fruits')">Fruits</div>
                <div class="itemFilter" onclick="sortCategory('Dairy Products')">Dairy</div>
                <div class="itemFilter" onclick="sortCategory('Baked Goods')">Baked Goods</div>
            </div>
        </div>

        <div class="categoriesContainer">

        </div>

    </div>

    <script>
        let navOpen = false;
        let fridgenavOpen = false;
        const shoppingCart = [];
        let categoryList = [
                {
                    categoryName: "Fruits",
                    items: [
                        { name: "Apple", image: "https://images.unsplash.com/photo-1568702846914-96b305d2aaeb?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBwbGV8ZW58MHx8MHx8fDI%3D" },
                        { name: "Banana", image: "https://images.unsplash.com/photo-1587132137056-bfbf0166836e?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YmFuYW5hfGVufDB8fDB8fHwy" },
                        // Add more items if needed
                    ]
                },
                {
                    categoryName: "Baked Goods",
                    items: [
                        { name: "Pretzel", image: "https://images.unsplash.com/photo-1609438824822-5b3a0e9abb4e?q=80&w=1887&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" },
                        { name: "Croissant", image: "https://images.unsplash.com/photo-1587912001191-0cd4f14fd89e?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" },
                        { name: "Donut", image: "https://images.unsplash.com/photo-1562945431-ce2b63d5a7fe?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},
                        { name: "Naan", image: "https://images.unsplash.com/photo-1678527033550-33b09e4ef268?q=80&w=1935&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},
                        { name: "Brownie", image: "https://images.unsplash.com/photo-1636743715220-d8f8dd900b87?q=80&w=1885&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},
                        { name: "Cookie", image: "https://images.unsplash.com/photo-1607114910421-a7c2b982d497?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"},
                        { name: "Pie", image: "https://images.unsplash.com/photo-1572383672419-ab35444a6934?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8cGllfGVufDB8fDB8fHwy"},
                        // Add more items if needed
                    ]
                },
                {
                    categoryName: "Dairy Products",
                    items: [
                        { name: "Milk", image: "https://images.unsplash.com/photo-1596151163116-98a5033814c2?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" },
                        { name: "Yogurt", image: "https://images.unsplash.com/photo-1562114808-b4b33cf60f4f?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8eW9ndXJ0fGVufDB8fDB8fHwy" },
                        { name: "Butter", image: "https://images.unsplash.com/photo-1589985270826-4b7bb135bc9d?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" },
                        { name: "Cheese", image: "https://images.unsplash.com/photo-1599791427176-0caab37538f3?q=80&w=1854&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" },
                        // Add more items if needed
                    ]
                }
            ];

        function toggleNav(sidenavId) {
            const isOpen = (sidenavId === "mySidenav") ? navOpen : fridgenavOpen;
            const width = isOpen ? "0" : "300px";

            if (sidenavId === "mySidenav") {
                navOpen = !navOpen;
            } else if (sidenavId === "fridgeSidenav") {
                fridgenavOpen = !fridgenavOpen;
            }

            document.getElementById(sidenavId).style.width = width;
        }

        function openFridgeNav(){
            fridgenavOpen = true;
            document.getElementById("fridgeSidenav").style.width = "300px";
        }

        function closeFridgeNav(){
            fridgenavOpen = false;
            document.getElementById("fridgeSidenav").style.width = "0px";
        }

        // update the fridge
        function updateFridge() {
            // Check if list is empty
            if (shoppingCart.length === 0) {
                alert("Please choose an item to put into inventory!");
            } else {
                // Put the list into local storage
                sessionStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));

                // Clear the list after updating local storage
                shoppingCart.splice(0, shoppingCart.length);
                // // Update
                // generateShoppingCartItems();
                alert("Inventory updated successfully!");
                
                window.location.href = "inventory.html";


            }
        }

        // Function to sort the categoryList based on the selected category
        function sortCategory(selectedCategory) {
            // Find the index of the selected category in the categoryList
            const selectedIndex = categoryList.findIndex(category => category.categoryName === selectedCategory);
            // If the selected category is found
            if (selectedIndex !== -1) {
                // Move the selected category to the beginning of the categoryList
                // splice returns a list, in this case a list of just 1 element, use the [0] to access that
                const selectedCategoryItem = categoryList.splice(selectedIndex, 1)[0];
                // unshift puts argument to the front of the list
                categoryList.unshift(selectedCategoryItem);
                // Regenerate categories and items based on the updated categoryList
                generateCategoriesAndItems();
                // generateShoppingCartItems();
            }
        }

        function generateCategoriesAndItems() {
            const categoriesContainer = document.querySelector('.categoriesContainer');

            // clear existing content in the container
            categoriesContainer.innerHTML = '';

            // Loop through the list of categories
            categoryList.forEach(category => {
                // main container for each category
                const categoryContainer = document.createElement('div');
                categoryContainer.className = 'category';

                // category name container
                const categoryNameContainer = document.createElement('div');
                categoryNameContainer.className = 'categoryName';
                const categoryName = document.createElement('p');
                categoryName.textContent = category.categoryName;
                categoryNameContainer.appendChild(categoryName);

                // items container for each category
                const itemsContainer = document.createElement('div');
                itemsContainer.className = 'itemsContainer';

                // Loop through the items in the category
                category.items.forEach(item => {
                    // main container for each item
                    const itemContainer = document.createElement('div');
                    itemContainer.className = 'item';

                    // image container
                    const imageContainer = document.createElement('div');
                    imageContainer.className = 'imageContainer';
                    const image = document.createElement('img');
                    image.src = item.image;
                    imageContainer.appendChild(image);

                    // text container
                    const textContainer = document.createElement('div');
                    textContainer.className = 'textContainer';
                    const itemName = document.createElement('p');
                    itemName.textContent = item.name;
                    const addButton = document.createElement('button');
                    addButton.textContent = 'Add to Inventory';

                    // Add counter for each item
                    const counter = document.createElement('span');
                    counter.textContent = '0';

                    // Add event listener to the "Add to Fridge" button
                    addButton.addEventListener('click', function() {
                        openFridgeNav();
                        // Find the item in the shopping cart
                        // for cartItem in shoppingCart
                        // if cartItem.name === item.name, then its found, then assign the item to cartItem
                        const cartItem = shoppingCart.find(cartItem => cartItem.name === item.name);

                        if (cartItem) {
                            // If the item is already in the cart, increment the counter
                            cartItem.quantity++;
                            counter.textContent = cartItem.quantity;
                        } else {
                            // If the item is not in the cart, add it with quantity 1
                            shoppingCart.push({ name: item.name, image: item.image, quantity: 1 });
                            counter.textContent = '1';
                        }
                        generateShoppingCartItems();
                    });

                    // Append elements to the text container
                    textContainer.appendChild(itemName);
                    textContainer.appendChild(addButton);

                    // Append image and text containers to the main item container
                    itemContainer.appendChild(imageContainer);
                    itemContainer.appendChild(textContainer);

                    // Append the main item container to the items container
                    itemsContainer.appendChild(itemContainer);
                });

                // Append category name and items container to the main category container
                categoryContainer.appendChild(categoryNameContainer);
                categoryContainer.appendChild(itemsContainer);

                // Append the main category container to the categories container
                categoriesContainer.appendChild(categoryContainer);
            });
        }

        // function for the fridge side bar, need better name :)
        function generateShoppingCartItems() {
            const itemsContainer = document.querySelector('.fridgeSidenav-itemsContainer');

            // clear existing content in the container
            itemsContainer.innerHTML = '';

            // Loop through the items in the list
            shoppingCart.forEach(item => {
                // main container for each item
                const itemContainer = document.createElement('div');
                itemContainer.className = 'fridgeSidenav-item';

                // image container
                const imageContainer = document.createElement('div');
                imageContainer.className = 'fridgeSidenav-imageContainer';
                const image = document.createElement('img');
                image.src = item.image;
                imageContainer.appendChild(image);

                // text container
                const textContainer = document.createElement('div');
                textContainer.className = 'fridgeSidenav-textContainer';
                const itemName = document.createElement('p');
                itemName.textContent = item.name;

                // incDec container
                const incDecContainer = document.createElement('div');
                incDecContainer.className = 'fridgeSidenav-incDec';

                // decrement button
                const decButton = document.createElement('div');
                decButton.className = 'incDecButton dec';
                decButton.textContent = '-';
                // event listener for decrementing the quantity
                decButton.addEventListener('click', function () {
                    item.quantity = Math.max(0, item.quantity - 1);
                    if (item.quantity ==0){
                        shoppingCart.splice(shoppingCart.indexOf(item), 1);
                        if (shoppingCart.length === 0){
                            closeFridgeNav();
                        }
                        generateShoppingCartItems(); // Update the displayed items after removing item 
                    }
                    quantityInput.value = item.quantity;
                });

                // the input for quantity
                const quantityInput = document.createElement('input');
                quantityInput.type = 'number';
                quantityInput.value = item.quantity;
                quantityInput.min = '0';
                quantityInput.readOnly = true;

                // increment button
                const incButton = document.createElement('div');
                incButton.className = 'incDecButton inc';
                incButton.textContent = '+';
                // event listener for incrementing the quantity
                incButton.addEventListener('click', function () {
                    item.quantity++;
                    quantityInput.value = item.quantity;
                });

                // Append elements to the incDec container
                incDecContainer.appendChild(decButton);
                incDecContainer.appendChild(quantityInput);
                incDecContainer.appendChild(incButton);

                // Append elements to the text container
                textContainer.appendChild(itemName);
                textContainer.appendChild(incDecContainer);

                // remove button
                const removeButton = document.createElement('div');
                removeButton.className = 'removeButton';
                removeButton.textContent = 'Remove';
                // event listener for removing the item from the shopping cart
                removeButton.addEventListener('click', function () {
                    shoppingCart.splice(shoppingCart.indexOf(item), 1);
                    if (shoppingCart.length === 0){
                        closeFridgeNav();
                    }
                    generateShoppingCartItems(); // update
                });

                // Append elements to the main item container
                itemContainer.appendChild(imageContainer);
                itemContainer.appendChild(textContainer);
                itemContainer.appendChild(removeButton);

                // Append the main item container to the shopping cart container
                itemsContainer.appendChild(itemContainer);
            });
        }

        window.onload = function () {
            generateCategoriesAndItems();
        };
    </script>

</body>

</html>